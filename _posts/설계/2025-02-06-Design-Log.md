---
categories:
- Design
date: '2025-02-06'
title: '[Design] Log'
---

{% raw %}
### 로그 포맷
일반적으로 로그 양식은 텍스트 형식이나 JSON 형식으로 출력되며, 각각의 형식은 특정 상황에 유리할 수 있습니다.

#### 텍스트 형식
텍스트 형식은 사람이 읽기 쉬운 형태로 로그를 출력하는 방법입니다. 이는 디버깅이나 간단한 모니터링에 유용하지만, 로그를 대규모로 처리하거나 분석하는 데는 불편할 수 있습니다.

```
INFO [2025-02-10 12:30:45] UserLoginService - 로그인 성공, UserID: 12345
ERROR [2025-02-10 12:31:00] UserLoginService - 로그인 실패, 오류: 잘못된 비밀번호
```

#### JSON 형식
JSON 형식은 구조화된 데이터를 표현하기 위한 형식으로, 로그 분석 도구에서 쉽게 처리할 수 있는 장점이 있습니다.

예시:
```
{
  message: 'User login attempted',
  userId: 12345,
  requestId: 'req-xyz',
  ipAddress: '192.168.0.1',
  method: 'POST',
  url: '/api/login',
  location: {
    file: 'userController.js',
    function: 'login',
    line: 25,
  },
};
```

#### 로그 출력 양식에서 포함할 수 있는 정보
로그 양식에는 다양한 정보가 포함될 수 있습니다.

- 타임스탬프: 로그가 생성된 시간.
- 로그 레벨`info`, `warn`, `error`, `debug` 등 로그의 중요도.
- 메시지: 실제 로그 내용.
- 요청 ID: 특정 요청을 추적할 수 있도록 하는 ID. 주로 분산 시스템에서 유용.
- 사용자 정보: 로그가 발생한 사용자의 정보.
- 서비스 이름: 로그를 발생시킨 서비스의 이름.
- 호스트 정보: 로그가 발생한 서버의 호스트명이나 IP.
- 에러 정보: 오류가 발생한 경우 에러 메시지 또는 스택 트레이스.
- 추가 데이터: 로그에 포함된 특정 데이터나 상태 정보.

### 로그 객체 타입
외부 라이브러리나 시스템에서 던지는 예외 타입이 매우 다양할 수 있기 때문에, 일일이 모든 가능성을 체크하는 것은 비효율적이고 불가능할 수 있습니다. 이때는 `any`나 `unknown`을 사용하는 것이 좋습니다.

### 로그 전파
> 하위 모듈에서 오류 로그 표시 vs 예외 전파를 통해 상위 모듈에서 오류 로그 표시<br>

**상위 모듈에서 오류 로그를 처리하는 방법**이 더 일관적이고 관리하기 좋습니다.

- **일관된 로그 처리**: 상위 모듈에서 모든 오류를 처리하면, 로그 처리의 일관성을 유지할 수 있습니다. 하나의 방식으로 오류를 관리하고, 로그도 통합적으로 처리할 수 있습니다.
- **중복 방지**: 오류를 한 곳에서 처리하므로, 중복된 오류 로그가 남지 않게 됩니다.
- **유연한 오류 처리**: 상위 모듈에서 오류를 처리하면서, 추가적인 로깅, 알림, 에러 응답 등을 일괄적으로 관리할 수 있습니다.
{% endraw %}