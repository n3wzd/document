---
categories:
- Zookeeper
date: '2025-02-10'
title: '[Zookeeper] Zookeeper'
---

{% raw %}
**Zookeeper**는 **분산 시스템**에서 **동기화**와 **메타데이터 저장**을 제공하는 **중앙 집중식 서비스**입니다. 주로 **분산 애플리케이션**에서 여러 서버나 컴포넌트 간의 **상태 관리**, **구성 관리**, **동기화**를 위해 사용됩니다. Kafka와 같은 시스템에서도 Zookeeper는 중요한 역할을 합니다.

1. **분산 동기화**: 분산 시스템에서 여러 노드가 동시에 접근하거나 수정할 수 있는 데이터에 대해 일관성 있는 상태를 유지합니다.
2. **구성 관리**: 여러 서버나 컴포넌트에서 공유해야 하는 설정 정보를 중앙에서 관리하고, 이를 실시간으로 업데이트할 수 있습니다.
3. **상태 관리**: 분산 시스템 내 여러 서비스들의 상태를 추적하고, 서비스의 **상태 변경**을 감지할 수 있습니다.
4. **리더 선출**: 여러 노드가 있을 때 **마스터-슬레이브** 모델을 구현하거나, **주기적인 작업**을 맡을 노드를 선택할 수 있습니다.

## 동작
Zookeeper는 **서버 클러스터**로 동작하며, 기본적으로 하나의 **마스터 서버(Leader)**와 여러 **팔로워 서버(Follower)**로 구성됩니다.

- **Leader**: 클러스터 내에서 모든 쓰기 작업을 처리합니다.
- **Follower**: 읽기 작업을 처리하며, Leader와 동기화된 상태를 유지합니다.
- **Observer**: 쓰기 작업에 참여하지 않지만, 클러스터의 상태를 읽기만 하는 서버입니다.

이렇게 **클러스터**가 **다중 노드**로 구성되어 **내구성**과 **고가용성**을 보장합니다.

## with Kafka
Kafka는 분산 시스템에서 동작하는 메시징 시스템인데, **Zookeeper**를 사용하여 **브로커 간의 상태 관리**, **파티션 할당**, **리더 선출** 등을 처리합니다. Kafka에서 Zookeeper의 주요 역할은 다음과 같습니다:
- **브로커 메타데이터 관리**: Kafka 클러스터 내 모든 브로커의 상태와 정보(예: 파티션 리더 등)를 Zookeeper에서 관리합니다.
- **파티션과 리더 관리**: 각 파티션의 리더를 관리하고, 리더가 다운되면 다른 브로커가 리더 역할을 하도록 합니다.
- **컨슈머 오프셋 추적**: Kafka에서 각 컨슈머가 읽은 오프셋을 Zookeeper에 저장하여, 컨슈머가 다시 시작할 때 마지막으로 읽었던 메시지부터 다시 시작할 수 있게 합니다.

Kafka 2.x부터 **KRaft 모드**(Kafka Raft Protocol)가 도입되어, Zookeeper를 대체할 수 있는 기능이 추가되었습니다. Kafka는 이제 Zookeeper 없이 자체적으로 클러스터를 관리할 수 있습니다. 그러나 여전히 많은 Kafka 사용자들은 기존의 Zookeeper를 사용하고 있습니다.
{% endraw %}