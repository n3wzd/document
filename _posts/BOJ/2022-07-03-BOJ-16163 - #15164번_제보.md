---
categories:
- BOJ
date: '2022-07-03'
title: '[BOJ] 16163 - #15164ë²ˆ_ì œë³´'
---

{% raw %}
> í”Œë˜í‹°ë„˜ V<br>

## ë¬¸ì œ
ì•ˆë…• ë°±ì¤€ëŒ€ìˆ² ì‚¬ëŒë“¤, ì–µìš¸í•œ ì¼ì´ ìˆì–´ìš”.

ì•…ë„í•œ jh05013ì´  ![*](https://upload.acmicpc.net/150f1ab6-a14f-4c6a-955f-0b7cf531558e/-/preview/)[**íšŒë¬¸ì€ íšŒë¬¸ì•„ë‹ˆì•¼!!**](https://www.acmicpc.net/problem/15927)![*](https://upload.acmicpc.net/150f1ab6-a14f-4c6a-955f-0b7cf531558e/-/preview/)  ì´ëŸ° ë¬¸ì œë¥¼ ëƒˆì–´ìš”. ê·¼ë° í‘¼ ì‚¬ëŒì´ ë„ˆë¬´ ë§ì€ ê±°ì˜ˆìš”!

> ë‚´ê°€ ì´ê±¸ ì•ˆ í’€ ìˆœ ì—†ì§€...<br>

ìƒê°í•˜ë©´ì„œ ê³ í†µë°›ìœ¼ë©´ì„œ  M ì–´ì©Œêµ¬ë‘  offline BITë¥¼ ì§°ë‹¤?

ê·¼ë° ì†”ë£¨ì…˜ì„ ë³´ë‹ˆê¹Œ ë‚´ê°€ ë©ì²­í•œ ê±°ì˜ˆìš”ã… ã…  ë°±ì£¼ë‰´ã… ã…  ê·¸ë“¤ì´ ì ˆ ê¸°ë§Œí–ˆì–´ìš”ã… ã… ã… 

ê·¸ë˜ì„œ ë‹¤ì‹œëŠ” ë‚šì´ì§€ ì•Šê² ë‹¤ê³  ìƒê°í–ˆì–´ìš”.

ê·¼ë° ì–¼ë§ˆ ì „ì— ëŒ€íšŒë¥¼ ì¹˜ë©´ì„œ  ![*](https://upload.acmicpc.net/150f1ab6-a14f-4c6a-955f-0b7cf531558e/-/preview/)[**ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” íŒ°ë¦°ë“œë¡¬ ë¶€ë¶„ìˆ˜ì—´**](https://www.acmicpc.net/problem/16161)![*](https://upload.acmicpc.net/150f1ab6-a14f-4c6a-955f-0b7cf531558e/-/preview/)  ë¬¸ì œë¥¼ ë´¤ì–´ìš”.

ì—´ì‹¬íˆ ìƒê°í–ˆëŠ”ë°  M ì–´ì©Œêµ¬ ë§ê³ ëŠ” ìƒê°ì´ ì•ˆ ë‚˜ì„œ

> ì™€ ì´ë²ˆì—” ì§„ì§œ M ì–´ì©Œêµ¬ë‹¤<br>

ìƒê°í•˜ë©´ì„œ ì—´ì‹¬íˆ  M  ì–´ì©Œêµ¬ë¥¼ ì§°ë‹¤?

ê·¼ë° ì´ë²ˆì—ë„ ë‚šì¸ ê±°ì˜ˆìš”ã… ã… ã… ã…  ì‚¬ëŒë“¤ ì½”ë“œ ê¸¸ì´ê°€ ë‹¤ ë„ˆë¬´ ì§§ì•„ã… ã… ã… ã… ã… ã…  í‚¤íŒŒ ë„ˆë¬´ ë©ì²­í•´ìš”ã… ã… ã… 

ì´ì œ í‚¤íŒŒëŠ” ê¸°ë§Œìë“¤ì—ê²Œ ë³µìˆ˜ì˜ ì² í‡´ë¥¼ ë‚ ë¦´ ê±°ì˜ˆìš”. ê·¸ëŸ¬ë‹ˆê¹Œ ì—¬ëŸ¬ë¶„ì´ ë¶€ë¶„ ë¬¸ìì—´ ì¤‘ íšŒë¬¸ì¸ ê²ƒì˜ ê°œìˆ˜ë¥¼ êµ¬í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ ì£¼ì„¸ìš”! ğŸ˜ˆ

### ì…ë ¥
ê¸¸ì´ê°€ 1 ì´ìƒ 200ë§Œ ì´í•˜ì¸ ë¬¸ìì—´ì„ ë“œë¦´ê²Œìš”. ì•ŒíŒŒë²³ ëŒ€ë¬¸ìë¡œë§Œ ì´ë£¨ì–´ì ¸ ìˆì–´ìš”!

### ì¶œë ¥
ì£¼ì–´ì§„ ë¬¸ìì—´ì˜ ë¶€ë¶„ ë¬¸ìì—´ ì¤‘ íšŒë¬¸ì¸ ê²ƒì˜ ê°œìˆ˜ë¥¼ ì¶œë ¥í•´ ì£¼ì„¸ìš”!

### ë…¸íŠ¸
ë¶€ë¶„ ë¬¸ìì—´ì€ ì›ë˜ ë¬¸ìì—´ì—ì„œ ì—°ì†í•´ì•¼ í•´ìš”! ì¦‰  `AA`ëŠ” `ABCBA`ì˜ ë¶€ë¶„ë¬¸ìì—´ì´ ì•„ë‹ˆì—ìš”.

ë¶€ë¶„ ë¬¸ìì—´ì„ ê°€ì ¸ì˜¨ ìœ„ì¹˜ê°€ ë‹¤ë¥´ë©´ ë‹¤ë¥¸ ë¬¸ìì—´ë¡œ í• ê²Œìš”! ê·¸ëŸ¬ë‹ˆê¹Œ ì˜ˆì œì—ì„œ íšŒë¬¸  `A`ëŠ” ë‘ ë²ˆ ì„¸ì–´ì¡Œì–´ìš”.

ì´ ë¬¸ì œëŠ” ì‹¤í™”ì˜ˆìš”ã… ã… ã… 

## í•´ê²°
> M ì–´ì©Œêµ¬ = `Manacher ì•Œê³ ë¦¬ì¦˜`<br>

Manacherì˜ A[i] ë°°ì—´ì€ ië²ˆ ë¬¸ìë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•˜ëŠ” ê°€ì¥ ê¸´ íšŒë¬¸ì˜ ë°˜ì§€ë¦„ í¬ê¸°ë‹¤. ì¦‰, (A[i] + 1) / 2ëŠ” ië²ˆ ë¬¸ìë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•˜ëŠ” íšŒë¬¸ì˜ ê°œìˆ˜í•˜ê³  ê°™ë‹¤.

(A[i] + 1) / 2ë¥¼ ëª¨ë‘ ë”í•˜ê³  ì¶œë ¥í•´ì„œ ë³µìˆ˜ì˜ ì² í‡´ë¥¼ ë‚ ë ¤ì£¼ì(?)

## ì½”ë“œ
```
#include <iostream>
using namespace std;
typedef long long ll;
const int SIZE = 2000002;
int A[SIZE * 2];

string MakePalin(string str) {
	int len = str.size();
	string S;
	for (int i = 0; i < len; i++) {
		S += "#";
		S += str[i];
	}
	S += "#";
	return S;
}

void Manachers(string S) {
	int maxR = 0, cen = 0, N = S.size();
	for (int i = 0; i < N; i++) {
		if (maxR - i >= 0 && 2 * cen - i >= 0)
			A[i] = min(A[2 * cen - i], maxR - i);

		while (i - (A[i] + 1) >= 0 && i + A[i] + 1 < N && S[i - (A[i] + 1)] == S[i + A[i] + 1])
			A[i]++;

		if (maxR < i + A[i]) {
			maxR = i + A[i];
			cen = i;
		}
	}
}

int main() {
	ios_base::sync_with_stdio(false); cin.tie(NULL); cout.tie(NULL);
	string input, s;
	cin >> input;<br>
	s = MakePalin(input);
	Manachers(s);

	int len = s.size();
	ll cnt = 0;
	for (int i = 0; i < len; i++)
		cnt += A[i] / 2;
	cout << cnt + input.size();
	return 0;
}
```

## ë§í¬
https://www.acmicpc.net/problem/16163

## ì¶œì œìê°€ ê³ í†µë°›ì•˜ë˜(?) ë¬¸ì œ
https://www.acmicpc.net/problem/15927
https://www.acmicpc.net/problem/16161
{% endraw %}